(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{1120:(e,a,r)=>{Promise.resolve().then(r.bind(r,4694))},1275:(e,a,r)=>{"use strict";r.d(a,{X:()=>o});var t=r(2115),s=r(2712);function o(e){let[a,r]=t.useState(void 0);return(0,s.N)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let a=new ResizeObserver(a=>{let t,s;if(!Array.isArray(a)||!a.length)return;let o=a[0];if("borderBoxSize"in o){let e=o.borderBoxSize,a=Array.isArray(e)?e[0]:e;t=a.inlineSize,s=a.blockSize}else t=e.offsetWidth,s=e.offsetHeight;r({width:t,height:s})});return a.observe(e,{box:"border-box"}),()=>a.unobserve(e)}r(void 0)},[e]),a}},2712:(e,a,r)=>{"use strict";r.d(a,{N:()=>s});var t=r(2115),s=globalThis?.document?t.useLayoutEffect:()=>{}},3655:(e,a,r)=>{"use strict";r.d(a,{hO:()=>n,sG:()=>i});var t=r(2115),s=r(7650),o=r(9708),c=r(5155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,a)=>{let r=t.forwardRef((e,r)=>{let{asChild:t,...s}=e,i=t?o.DX:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,c.jsx)(i,{...s,ref:r})});return r.displayName=`Primitive.${a}`,{...e,[a]:r}},{});function n(e,a){e&&s.flushSync(()=>e.dispatchEvent(a))}},3924:(e,a,r)=>{"use strict";r.d(a,{A:()=>m});var t=r(5155);r(2115);var s=r(2338),o=r(9074),c=r(6376),i=r(4186),n=r(4516),l=r(5095),d=r(540);let m=e=>{let a,r,{appointment:m,onReschedule:u,onConfirm:p}=e;if(!m)return(0,t.jsxs)(s.Zp,{className:"w-full",children:[(0,t.jsx)(s.aR,{className:"bg-care-purple text-white rounded-t-lg",children:(0,t.jsxs)(s.ZB,{className:"text-white flex items-center",children:[(0,t.jsx)(o.A,{className:"mr-2 h-5 w-5"}),"Pr\xf3xima Consulta"]})}),(0,t.jsx)(s.Wu,{className:"pt-5",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-6",children:[(0,t.jsx)(c.A,{className:"h-16 w-16 text-care-purple mb-3"}),(0,t.jsx)("h3",{className:"text-xl font-medium text-care-purple mb-2",children:"Nenhuma consulta agendada"}),(0,t.jsx)("p",{className:"text-care-purple mb-4 text-center",children:"Voc\xea ainda n\xe3o possui consultas agendadas. Clique no bot\xe3o abaixo para agendar uma nova consulta."})]})})]});try{let[e,t,s]=m.date.split("-");a=new Date(parseInt(e),parseInt(t)-1,parseInt(s)),r=(0,l.m)(a,{addSuffix:!0,locale:d.F})}catch(e){console.warn("Erro ao formatar data no AppointmentCard:",m.date,e),a=new Date,r="Data inv\xe1lida"}return(0,t.jsxs)(s.Zp,{className:"w-full",children:[(0,t.jsx)(s.aR,{className:"bg-care-purple text-white rounded-t-lg",children:(0,t.jsxs)(s.ZB,{className:"text-white flex items-center",children:[(0,t.jsx)(o.A,{className:"mr-2 h-5 w-5"}),"Pr\xf3xima Consulta"]})}),(0,t.jsx)(s.Wu,{className:"pt-5",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("h3",{className:"text-care-purple",children:m.doctorName}),(0,t.jsx)("p",{className:"text-care-purple",children:m.specialty})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-care-purple mr-2"}),(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-care-purple",children:[a.toLocaleDateString("pt-BR"),(0,t.jsxs)("span",{className:"text-care-purple ml-1",children:["(",r,")"]})]})})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(i.A,{className:"h-5 w-5 text-care-purple mr-2"}),(0,t.jsx)("p",{className:"text-care-purple",children:m.time})]}),(0,t.jsxs)("div",{className:"flex items-start",children:[(0,t.jsx)(n.A,{className:"h-5 w-5 text-care-purple mr-2 mt-1"}),(0,t.jsx)("div",{children:(0,t.jsxs)("p",{className:"text-care-purple font-medium",children:[m.locationName," - ",m.locationAddress]})})]}),m.confirmed&&(0,t.jsx)("div",{className:"flex items-center justify-center p-2 bg-green-100 text-green-600 rounded-md",children:(0,t.jsx)("span",{children:"Presen\xe7a Confirmada"})})]})})]})}},4616:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(9946).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},4694:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>W});var t=r(5155),s=r(2182),o=r(6218),c=r(2115),i=r(8496),n=r(6874),l=r.n(n),d=r(1007),m=r(2338),u=r(215),p=r(4616),h=r(5196),x=r(3861),f=r(4186),g=r(6671);let j=()=>{let[e,a]=c.useState([]),[r,s]=c.useState(!0),[o,n]=c.useState(!1);(0,c.useEffect)(()=>{j()},[]),(0,c.useEffect)(()=>{let e=setInterval(()=>{a(e=>[...e])},6e4);return()=>clearInterval(e)},[]);let d=e=>{let a=new Date,r=60*a.getHours()+a.getMinutes(),[t,s]=e.split(":").map(Number);return r>60*t+s};async function j(){let e=localStorage.getItem("authToken"),r=localStorage.getItem("userId");if(!e||!r){console.error("Token de autentica\xe7\xe3o ou ID do usu\xe1rio n\xe3o encontrado."),s(!1),g.oR.error("Por favor, fa\xe7a login novamente.");return}try{s(!0);let r=await fetch("/api/medications",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(401===r.status){console.error("Token inv\xe1lido ou expirado"),localStorage.removeItem("authToken"),localStorage.removeItem("userId"),g.oR.error("Sua sess\xe3o expirou. Por favor, fa\xe7a login novamente.");return}if(!r.ok)throw Error("Erro ao buscar medicamentos: ".concat(r.status));let t=(await r.json()).map(e=>({id:e.id,medicationName:e.medicationName||e.name,medicationTime:e.medicationTime||e.time,taken:e.taken||!1,name:e.name||e.medicationName,time:e.time||e.medicationTime,dosage:e.dosage||"",reminder:e.reminder||!1}));a(t),n(0===t.length)}catch(e){console.error("Erro ao carregar medicamentos:",e),g.oR.error("Erro ao carregar medicamentos")}finally{s(!1)}}let v=async r=>{let t=localStorage.getItem("authToken");if(!t)return void g.oR.error("Token de autentica\xe7\xe3o n\xe3o encontrado.");try{let s=await fetch("/api/medications/".concat(r),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({taken:!0})});if(401===s.status)return void g.oR.error("Sua sess\xe3o expirou. Por favor, fa\xe7a login novamente.");if(404===s.status)return void g.oR.error("Medicamento n\xe3o encontrado ou voc\xea n\xe3o tem acesso a ele.");if(!s.ok)throw Error("Erro ao atualizar medicamento");await s.json();let o=e.find(e=>e.id===r),c=o&&d(o.time),i=e.map(e=>e.id===r?{...e,taken:!0}:e);a(i),c?g.oR.success("Medicamento registrado! Tente manter os hor\xe1rios para melhor efic\xe1cia.",{description:"".concat(null==o?void 0:o.name," foi marcado como tomado com atraso.")}):g.oR.success("\xd3timo! Medicamento tomado no hor\xe1rio correto.",{description:"".concat(null==o?void 0:o.name," registrado com sucesso.")})}catch(e){console.error("Erro ao marcar medicamento como tomado:",e),g.oR.error("Erro ao registrar medicamento")}},b=async r=>{let t=localStorage.getItem("authToken");if(!t)return void g.oR.error("Token de autentica\xe7\xe3o n\xe3o encontrado.");let s=e.find(e=>e.id===r);if(!s)return void g.oR.error("Medicamento n\xe3o encontrado.");try{let o=await fetch("/api/medications/".concat(r),{method:"PUT",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify({reminder:!0})});if(401===o.status)return void g.oR.error("Sua sess\xe3o expirou. Por favor, fa\xe7a login novamente.");if(404===o.status)return void g.oR.error("Medicamento n\xe3o encontrado ou voc\xea n\xe3o tem acesso a ele.");if(!o.ok)throw Error("Erro ao configurar lembrete");let c=e.map(e=>e.id===r?{...e,reminder:!0}:e);if(a(c),g.oR.success("Lembrete configurado para ".concat(s.name," \xe0s ").concat(s.time)),"Notification"in window){if("granted"===Notification.permission)setTimeout(()=>{new Notification("Lembrete ativado: ".concat(s.name),{body:"Voc\xea receber\xe1 notifica\xe7\xf5es para tomar ".concat(s.dosage," \xe0s ").concat(s.time),icon:"/favicon.svg"})},1e3);else if("denied"!==Notification.permission){let e=await Notification.requestPermission();"granted"===e&&g.oR.success("Notifica\xe7\xf5es ativadas! Voc\xea receber\xe1 lembretes no navegador.")}}}catch(e){console.error("Erro ao configurar lembrete:",e),g.oR.error("Erro ao configurar lembrete")}},N=e.filter(e=>!e.taken).slice(0,3),w=N.filter(e=>d(e.time)).length;return r?(0,t.jsxs)(m.Zp,{className:"w-full",children:[(0,t.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(u.A,{className:"h-6 w-6 text-care-purple"}),(0,t.jsx)(m.ZB,{className:"text-lg",children:"Medicamentos"})]}),(0,t.jsx)("div",{className:"h-8 w-20 bg-gray-200 rounded animate-pulse"})]}),(0,t.jsxs)(m.Wu,{children:[w>0&&!r&&!o&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),(0,t.jsx)("p",{className:"text-red-700 font-medium text-sm",children:1===w?"Voc\xea tem 1 medicamento em atraso":"Voc\xea tem ".concat(w," medicamentos em atraso")})]}),(0,t.jsx)("p",{className:"text-red-600 text-xs mt-1 ml-4",children:"Verifique os hor\xe1rios abaixo e registre os medicamentos tomados."})]}),(0,t.jsx)("div",{className:"space-y-3",children:[1,2,3].map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 bg-gray-200 rounded-full animate-pulse"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"h-4 w-24 bg-gray-200 rounded animate-pulse mb-1"}),(0,t.jsx)("div",{className:"h-3 w-20 bg-gray-200 rounded animate-pulse"})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("div",{className:"h-8 w-16 bg-gray-200 rounded animate-pulse"}),(0,t.jsx)("div",{className:"h-8 w-14 bg-gray-200 rounded animate-pulse"})]})]},e))})]})]}):(0,t.jsxs)(m.Zp,{className:"w-full",children:[(0,t.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(u.A,{className:"h-6 w-6 text-care-purple"}),(0,t.jsx)(m.ZB,{className:"text-lg",children:"Medicamentos"})]}),(0,t.jsx)(l(),{href:"/dashboard/medications",children:(0,t.jsx)(i.$,{size:"sm",className:"hover:bg-care-teal bg-care-dark-teal text-white",children:"Ver todos"})})]}),(0,t.jsx)(m.Wu,{children:o?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-care-purple/10 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(u.A,{className:"h-8 w-8 text-care-purple"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-care-purple mb-2",children:"Nenhum medicamento cadastrado"}),(0,t.jsx)("p",{className:"text-care-purple mb-6 max-w-sm mx-auto",children:"Voc\xea ainda n\xe3o adicionou nenhum medicamento ao seu plano de cuidados. Comece adicionando seus medicamentos para receber lembretes."}),(0,t.jsx)(l(),{href:"/dashboard/medications",children:(0,t.jsxs)(i.$,{className:"bg-care-teal hover:bg-care-dark-teal",children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Adicionar Medicamento"]})})]}):0===N.length?(0,t.jsxs)("div",{className:"text-center py-6",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(h.A,{className:"h-8 w-8 text-green-600"})}),(0,t.jsx)("h3",{className:"text-lg font-medium text-care-purple mb-2",children:"Parab\xe9ns! \uD83C\uDF89"}),(0,t.jsx)("p",{className:"text-care-purple mb-4",children:"Todos os medicamentos de hoje foram tomados!"}),(0,t.jsx)(l(),{href:"/dashboard/medications",children:(0,t.jsx)(i.$,{className:"hover:bg-care-teal bg-care-dark-teal text-white",children:"Ver todos os medicamentos"})})]}):(0,t.jsxs)("div",{className:"space-y-3",children:[N.map(e=>{let a=!e.taken&&d(e.time),r=e.reminder;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border transition-colors ".concat(a?"bg-red-50 border-red-200 hover:border-red-300":"bg-gray-50 border-gray-100 hover:border-care-teal/20"),children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(e.taken?"bg-green-500":a?"bg-red-500 animate-pulse":"bg-yellow-500")}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("p",{className:"font-medium text-care-purple",children:e.name}),r&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-1 bg-care-purple/10 text-care-purple text-xs rounded-full",children:[(0,t.jsx)(x.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Lembrete ativo"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center text-care-purple",children:[(0,t.jsx)(f.A,{className:"h-3 w-3 mr-1"}),e.dosage," \xe0s ",e.time]}),a&&(0,t.jsxs)("span",{className:"text-red-500 font-medium",children:["• ",(e=>{let a=new Date,r=60*a.getHours()+a.getMinutes(),[t,s]=e.split(":").map(Number),o=r-(60*t+s);if(o<60)return"".concat(o," min atraso");{let e=Math.floor(o/60),a=o%60;return"".concat(e,"h").concat(a>0?a+"m":""," atraso")}})(e.time)]})]})]})]}),(0,t.jsx)("div",{className:"flex space-x-2",children:!e.taken&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.$,{size:"sm",variant:"outline",onClick:()=>b(e.id),disabled:r,className:"flex items-center space-x-1 ".concat(r?"border-gray-200 text-care-purple cursor-not-allowed":"border-care-purple/20 text-care-purple hover:bg-care-purple/5"),children:[(0,t.jsx)(x.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:r?"Configurado":"Lembrete"})]}),(0,t.jsxs)(i.$,{size:"sm",onClick:()=>v(e.id),className:"flex items-center space-x-1 ".concat(a?"bg-red-600 hover:bg-red-700":"bg-care-teal hover:bg-care-dark-teal"),children:[(0,t.jsx)(h.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:a?"Marcar como tomado":"Tomei"})]})]})})]},e.id)}),(0,t.jsx)(i.$,{variant:"ghost",className:"w-full mt-4 text-care-teal hover:text-care-dark-teal hover:bg-care-teal/5",asChild:!0,children:(0,t.jsxs)(l(),{href:"/dashboard/medications",children:[(0,t.jsx)(u.A,{className:"h-5 w-5 mr-2"}),"Gerenciar Medicamentos"]})})]})})]})};var v=r(3924),b=r(4516);let N=(0,r(9946).A)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var w=r(5185),y=r(6101),k=r(6081),E=r(5845),A=r(5503),S=r(1275),R=r(3655),z="Switch",[T,C]=(0,k.A)(z),[I,P]=T(z),M=c.forwardRef((e,a)=>{let{__scopeSwitch:r,name:s,checked:o,defaultChecked:i,required:n,disabled:l,value:d="on",onCheckedChange:m,form:u,...p}=e,[h,x]=c.useState(null),f=(0,y.s)(a,e=>x(e)),g=c.useRef(!1),j=!h||u||!!h.closest("form"),[v=!1,b]=(0,E.i)({prop:o,defaultProp:i,onChange:m});return(0,t.jsxs)(I,{scope:r,checked:v,disabled:l,children:[(0,t.jsx)(R.sG.button,{type:"button",role:"switch","aria-checked":v,"aria-required":n,"data-state":O(v),"data-disabled":l?"":void 0,disabled:l,value:d,...p,ref:f,onClick:(0,w.m)(e.onClick,e=>{b(e=>!e),j&&(g.current=e.isPropagationStopped(),g.current||e.stopPropagation())})}),j&&(0,t.jsx)(L,{control:h,bubbles:!g.current,name:s,value:d,checked:v,required:n,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});M.displayName=z;var D="SwitchThumb",B=c.forwardRef((e,a)=>{let{__scopeSwitch:r,...s}=e,o=P(D,r);return(0,t.jsx)(R.sG.span,{"data-state":O(o.checked),"data-disabled":o.disabled?"":void 0,...s,ref:a})});B.displayName=D;var L=e=>{let{control:a,checked:r,bubbles:s=!0,...o}=e,i=c.useRef(null),n=(0,A.Z)(r),l=(0,S.X)(a);return c.useEffect(()=>{let e=i.current,a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(n!==r&&a){let t=new Event("click",{bubbles:s});a.call(e,r),e.dispatchEvent(t)}},[n,r,s]),(0,t.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...o,tabIndex:-1,ref:i,style:{...e.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function O(e){return e?"checked":"unchecked"}var $=r(4143);let Z=c.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,t.jsx)(M,{className:(0,$.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...s,ref:a,children:(0,t.jsx)(B,{className:(0,$.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});Z.displayName=M.displayName;let _=()=>{let[e,a]=(0,c.useState)(!1),[r,s]=(0,c.useState)(!0),[o,n]=(0,c.useState)(null);(0,c.useEffect)(()=>{let e=localStorage.getItem("userId");n(e),e?l(e):s(!1)},[]);let l=async e=>{try{let r=localStorage.getItem("authToken");if(!r){console.log("❌ Token n\xe3o encontrado"),s(!1);return}let t=await fetch("/api/users/".concat(e,"/location-permission"),{headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();a(e.locationPermission)}else console.error("❌ Erro ao carregar permiss\xe3o de localiza\xe7\xe3o")}catch(e){console.error("❌ Erro ao carregar permiss\xe3o de localiza\xe7\xe3o:",e)}finally{s(!1)}},d=async()=>{if(!o)return void g.oR.error("Usu\xe1rio n\xe3o identificado");try{let r=localStorage.getItem("authToken");if(!r)return void g.oR.error("Token de autentica\xe7\xe3o n\xe3o encontrado");let t=!e,s=await fetch("/api/users/".concat(o,"/location-permission"),{method:"PUT",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"},body:JSON.stringify({locationPermission:t})});if(s.ok)await s.json(),a(t),t?g.oR.success("Localiza\xe7\xe3o ativada",{description:"Seus cuidadores podem ver sua localiza\xe7\xe3o agora."}):g.oR.info("Localiza\xe7\xe3o desativada",{description:"Sua localiza\xe7\xe3o n\xe3o ser\xe1 mais compartilhada."});else{let e=await s.json();g.oR.error("Erro ao atualizar permiss\xe3o",{description:e.message||"Tente novamente."})}}catch(e){console.error("❌ Erro ao atualizar permiss\xe3o de localiza\xe7\xe3o:",e),g.oR.error("Erro ao atualizar permiss\xe3o",{description:"Tente novamente."})}},u=async()=>{if(!e)return void g.oR.error("Permiss\xe3o de localiza\xe7\xe3o desativada",{description:"Ative a permiss\xe3o de localiza\xe7\xe3o antes de compartilhar."});try{if(!navigator.geolocation)return void g.oR.error("Geolocaliza\xe7\xe3o n\xe3o suportada",{description:"Seu navegador n\xe3o suporta geolocaliza\xe7\xe3o."});navigator.geolocation.getCurrentPosition(e=>{let{latitude:a,longitude:r}=e.coords;console.log("\uD83D\uDCCD Localiza\xe7\xe3o obtida:",{latitude:a,longitude:r}),g.oR.success("Localiza\xe7\xe3o compartilhada",{description:"Enviada para seus contatos de emerg\xeancia. (".concat(a.toFixed(4),", ").concat(r.toFixed(4),")")})},e=>{console.error("❌ Erro ao obter localiza\xe7\xe3o:",e);let a="Erro ao obter localiza\xe7\xe3o.";switch(e.code){case e.PERMISSION_DENIED:a="Permiss\xe3o de localiza\xe7\xe3o negada pelo usu\xe1rio.";break;case e.POSITION_UNAVAILABLE:a="Informa\xe7\xe3o de localiza\xe7\xe3o indispon\xedvel.";break;case e.TIMEOUT:a="Tempo limite excedido para obter localiza\xe7\xe3o."}g.oR.error("Erro ao obter localiza\xe7\xe3o",{description:a})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}catch(e){console.error("❌ Erro ao compartilhar localiza\xe7\xe3o:",e),g.oR.error("Erro ao compartilhar localiza\xe7\xe3o",{description:"Tente novamente."})}};return r?(0,t.jsxs)(m.Zp,{className:"w-full",children:[(0,t.jsx)(m.aR,{className:"bg-care-purple text-white rounded-t-lg",children:(0,t.jsxs)(m.ZB,{className:"text-care-purple-lg flex items-center",children:[(0,t.jsx)(b.A,{className:"mr-2 h-5 w-5"}),"Localiza\xe7\xe3o"]})}),(0,t.jsx)(m.Wu,{className:"pt-5",children:(0,t.jsxs)("div",{className:"flex items-center justify-center h-20",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-care-light-purple"}),(0,t.jsx)("span",{className:"ml-2 text-care-purple",children:"Carregando..."})]})})]}):(0,t.jsxs)(m.Zp,{className:"w-full",children:[(0,t.jsx)(m.aR,{className:"bg-care-purple text-white rounded-t-lg",children:(0,t.jsxs)(m.ZB,{className:"text-care-purple-lg flex items-center",children:[(0,t.jsx)(b.A,{className:"mr-2 h-5 w-5"}),"Localiza\xe7\xe3o"]})}),(0,t.jsxs)(m.Wu,{className:"pt-5",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full mr-2 ".concat(e?"bg-green-500 animate-pulse":"bg-gray-400")}),(0,t.jsx)("span",{className:"font-medium text-care-purple",children:e?"Localiza\xe7\xe3o ativa":"Localiza\xe7\xe3o desativada"})]}),(0,t.jsx)(Z,{checked:e,onCheckedChange:d,className:"data-[state=checked]:bg-care-light-purple"})]}),(0,t.jsx)("p",{className:"text-care-purple mb-4 text-care-purple",children:e?"Seus cuidadores podem ver sua localiza\xe7\xe3o em tempo real.":"Ative para permitir que seus cuidadores vejam sua localiza\xe7\xe3o."}),(0,t.jsxs)(i.$,{className:"w-full bg-care-purple hover:bg-care-light-purple text-white flex items-center justify-center",onClick:u,disabled:!e,children:[(0,t.jsx)(N,{className:"mr-2 h-5 w-5"}),"Compartilhar Localiza\xe7\xe3o Atual"]})]})]})};var q=r(6974);let V=()=>{let[e,a]=(0,c.useState)(null),[r,s]=(0,c.useState)(!0),[o,n]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{let e=localStorage.getItem("authToken"),a=localStorage.getItem("userId");if(!e||!a)return g.oR.error("Dados de autentica\xe7\xe3o n\xe3o encontrados.");try{let r=await fetch("/api/users/".concat(a),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok)throw Error("Erro ao buscar dados do usu\xe1rio");let t=await r.json();console.log("Dados do usu\xe1rio:",t),n(t)}catch(e){console.error("Erro ao buscar usu\xe1rio:",e),g.oR.error("Erro ao carregar dados do usu\xe1rio")}})()},[]),(0,c.useEffect)(()=>{o&&m()},[o]);let m=async()=>{let e=localStorage.getItem("authToken");if(!e)return void g.oR.error("Token n\xe3o encontrado.");try{let r=await fetch("/api/appointments",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!r.ok)throw Error("Erro ao buscar appointments");let t=await r.json();console.log("\uD83D\uDCCB Dados brutos da API:",t);let s=t.map(e=>{var a,r,t,s,o;return{...e,doctorName:(null==(a=e.doctor)?void 0:a.doctorName)||e.doctorName,specialty:(null==(r=e.doctor)?void 0:r.specialty)||e.specialty,locationName:(null==(t=e.location)?void 0:t.locationName)||e.locationName,locationAddress:(null==(s=e.location)?void 0:s.locationAddress)||e.locationAddress,locationCity:(null==(o=e.location)?void 0:o.locationCity)||e.locationCity}});console.log("✅ Dados mapeados:",s);let o=new Date,c=o.toISOString().split("T")[0],i=60*o.getHours()+o.getMinutes(),n=null,l=1/0;for(let e of s)try{let a=e.date,[r,t]=e.time.split(":").map(Number),s=60*r+t;if(a>c||a===c&&s>i){let r=new Date("".concat(a,"T").concat(e.time,":00")).getTime()-o.getTime();r<l&&(l=r,n=e)}}catch(a){console.warn("Erro ao processar agendamento: ".concat(e.date," ").concat(e.time),a)}console.log("\uD83C\uDFAF Pr\xf3xima consulta encontrada:",n),a(n)}catch(e){console.error("❌ Erro ao carregar consultas:",e),g.oR.error("Erro ao carregar pr\xf3xima consulta")}finally{s(!1)}},u=async e=>{try{await (0,q.qk)(e)?(g.oR.success("Presen\xe7a confirmada com sucesso!"),await m()):g.oR.error("Erro ao confirmar presen\xe7a. Tente novamente.")}catch(e){console.error("Error confirming appointment:",e),g.oR.error("Erro ao confirmar presen\xe7a")}};return r?(0,t.jsx)("div",{className:"care-container py-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-center h-32",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-care-teal"}),(0,t.jsx)("span",{className:"ml-2 text-gray-600",children:"Carregando..."})]})}):(0,t.jsxs)("div",{className:"care-container py-6",children:[(0,t.jsxs)("div",{className:"mb-8 mt-4 flex items-center",children:[(0,t.jsx)("div",{className:"mr-4 rounded-full bg-care-purple/10 p-2",children:(0,t.jsx)(d.A,{className:"h-6 w-6 sm:h-16 sm:w-16 text-care-purple"})}),(0,t.jsxs)("div",{className:"ml-4 text-care-purple",children:[(0,t.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold",children:["Ol\xe1, ",(null==o?void 0:o.userFirstName)||"Usu\xe1rio"]}),(0,t.jsx)("p",{className:"text-senior text-care-purple",children:"Bem-vindo ao Care Idosos"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsx)(j,{}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(v.A,{appointment:e,onReschedule:e=>{window.location.href="/dashboard/appointments"},onConfirm:u}),(0,t.jsx)(_,{})]})]}),(0,t.jsxs)("div",{className:"mt-8 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-4",children:[(0,t.jsx)(l(),{href:"/dashboard/appointments",children:(0,t.jsx)(i.$,{className:"hover:bg-care-teal bg-care-dark-teal h-16 text-white w-full",size:"lg",children:"Agendar Consulta"})}),(0,t.jsx)(l(),{href:"/dashboard/profile",children:(0,t.jsx)(i.$,{className:"hover:bg-care-light-purple bg-care-purple h-16 w-full text-white",size:"lg",children:"Servi\xe7os de Sa\xfade"})})]})]})};function W(){return(0,t.jsx)(o.A,{children:(0,t.jsx)(s.A,{children:(0,t.jsx)(V,{})})})}},5185:(e,a,r)=>{"use strict";function t(e,a,{checkForDefaultPrevented:r=!0}={}){return function(t){if(e?.(t),!1===r||!t.defaultPrevented)return a?.(t)}}r.d(a,{m:()=>t})},5196:(e,a,r)=>{"use strict";r.d(a,{A:()=>t});let t=(0,r(9946).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},5845:(e,a,r)=>{"use strict";r.d(a,{i:()=>o});var t=r(2115),s=r(9033);function o({prop:e,defaultProp:a,onChange:r=()=>{}}){let[o,c]=function({defaultProp:e,onChange:a}){let r=t.useState(e),[o]=r,c=t.useRef(o),i=(0,s.c)(a);return t.useEffect(()=>{c.current!==o&&(i(o),c.current=o)},[o,c,i]),r}({defaultProp:a,onChange:r}),i=void 0!==e,n=i?e:o,l=(0,s.c)(r);return[n,t.useCallback(a=>{if(i){let r="function"==typeof a?a(e):a;r!==e&&l(r)}else c(a)},[i,e,c,l])]}},6081:(e,a,r)=>{"use strict";r.d(a,{A:()=>c,q:()=>o});var t=r(2115),s=r(5155);function o(e,a){let r=t.createContext(a),o=e=>{let{children:a,...o}=e,c=t.useMemo(()=>o,Object.values(o));return(0,s.jsx)(r.Provider,{value:c,children:a})};return o.displayName=e+"Provider",[o,function(s){let o=t.useContext(r);if(o)return o;if(void 0!==a)return a;throw Error(`\`${s}\` must be used within \`${e}\``)}]}function c(e,a=[]){let r=[],o=()=>{let a=r.map(e=>t.createContext(e));return function(r){let s=r?.[e]||a;return t.useMemo(()=>({[`__scope${e}`]:{...r,[e]:s}}),[r,s])}};return o.scopeName=e,[function(a,o){let c=t.createContext(o),i=r.length;r=[...r,o];let n=a=>{let{scope:r,children:o,...n}=a,l=r?.[e]?.[i]||c,d=t.useMemo(()=>n,Object.values(n));return(0,s.jsx)(l.Provider,{value:d,children:o})};return n.displayName=a+"Provider",[n,function(r,s){let n=s?.[e]?.[i]||c,l=t.useContext(n);if(l)return l;if(void 0!==o)return o;throw Error(`\`${r}\` must be used within \`${a}\``)}]},function(...e){let a=e[0];if(1===e.length)return a;let r=()=>{let r=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=r.reduce((a,{useScope:r,scopeName:t})=>{let s=r(e)[`__scope${t}`];return{...a,...s}},{});return t.useMemo(()=>({[`__scope${a.scopeName}`]:s}),[s])}};return r.scopeName=a.scopeName,r}(o,...a)]}},6974:(e,a,r)=>{"use strict";r.d(a,{oZ:()=>s,qk:()=>o});var t=r(2387);let s=e=>{let a=[],r=[8,9,10,11,13,14,15,16,17];return r.forEach((e,t)=>{let s=Math.random()>.3;a.push({id:t+1,time:"".concat(e,":00"),available:s}),a.push({id:r.length+t+1,time:"".concat(e,":30"),available:Math.random()>.3})}),a},o=async e=>null!==await (0,t.yJ)("/appointment/confirmed/".concat(e),{})},9033:(e,a,r)=>{"use strict";r.d(a,{c:()=>s});var t=r(2115);function s(e){let a=t.useRef(e);return t.useEffect(()=>{a.current=e}),t.useMemo(()=>(...e)=>a.current?.(...e),[])}}},e=>{e.O(0,[9022,6356,8538,9712,3309,408,4459,8441,5964,7358],()=>e(e.s=1120)),_N_E=e.O()}]);